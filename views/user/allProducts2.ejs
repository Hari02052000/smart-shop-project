

<style>
	
	#category-select {
  padding: 10px;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: 16px;
}
</style>


	<!-- <form id="search-form">
      <input type="text" name="search"  placeholder="search by brand prodectName catogery">
      <button type="submit">search</button><br>

      <label>catogery</label>
      <select name="category">
        <option >All</option>
        <% category.forEach(function(i){ %>
         <option value="<%=i._id%>"><%=i.category%></option>
        <% }) %>
      </select><br>
      <button type="submit">applay filter</button>
      <label for="sort">Price:</label>
      <input type="radio" name="sort" value="asc" > low-to-high
      <input type="radio" name="sort" value="desc">high-to-low
      <button type="submit">sort </button>
     </form>	
    <div class="product-list" id="allprodect">
        
        
    </div>
    <div id="pageNumber" class >
       
    </div>
</div>
</body> -->

<!--  -->

<section class="breadcrumb_part">
	<div class="container">
		<div class="row">
			<div class="col-lg-12">
				<div class="breadcrumb_iner">
					<h2>product list</h2>
				</div>
			</div>
		</div>
	</div>
</section>

<!-- product list part start-->
<section class="product_list section_padding">
	<div class="container">
		<div class="row">
			<div class="col-md-4">
				<div class="input-group">
					<div class="form-outline">
					  <input type="search" id="form1" class="form-control" placeholder="search here..."/><br>
					  <label>catogery</label>
      <select name="category" >
        <option >All</option>
        <% category.forEach(function(i){ %>
         <option value="<%=i._id%>"><%=i.category%></option>
        <% }) %>
      </select><br>
	
					  
      <input type="radio" name="sort" value="asc" > low-to-high
      <input type="radio" name="sort" value="desc">high-to-low
				  </div>
					</div>
					
				  
				<!-- <div class="product_sidebar">
					<div class="single_sedebar">
						<form action="#">
							<input type="text" name="#" placeholder="Search keyword">
							<i class="ti-search"></i>
						</form>
					</div>
					<div class="single_sedebar"> 
						<div class="select_option"> 
							<div class="select_option_list">Category <i class="right fas fa-caret-down"></i> </div> 
							<div class="select_option_dropdown"> 
								
								<option value="6">Category 1</option>
								<p><a href="#">Category 2</a></p>
								<p><a href="#">Category 3</a></p>
								<p><a href="#">Category 4</a></p> 
							</div>
						</div>
					</div>
					<div class="single_sedebar">
						<div class="select_option">
							<div class="select_option_list">Type <i class="right fas fa-caret-down"></i> </div>
							<div class="select_option_dropdown">
								<p><a href="#">Type 1</a></p>
								<p><a href="#">Type 2</a></p>
								<p><a href="#">Type 3</a></p>
								<p><a href="#">Type 4</a></p>
							</div>
						</div>
					</div> 
				</div>-->
			</div>
			<div class="col-md-8">
				<div class="product_list">
					<div id="allProduct" class="row">
						
							<!-- all list -->
					</div>
				</div>
				<div id="pageNumber" class >
       
				</div>
            </div>
        </div>
		
    </section>	
                      
						



<!--  -->
<script>
let query
let category
let sort
let page=1


findall();
async function findall(){
const url=`/search?q=${query}&category=${category}&sort=${sort}&page=${page}`
console.log('start')
document.getElementById('allProduct').innerHTML=""
document.getElementById('pageNumber').innerHTML=""
const res= await fetch(url)
const data=await res.json()
console.log(data)
let single
if(data.products.length==0){
single=`
<div class="product">
	<p>no item found</p>
                    <img src="https://ibellstore.com/images/no-item-found-here.png" alt="no order"
                        style="width: 400px; height:300px ;">
                </div>
`
document.getElementById('allProduct').insertAdjacentHTML('beforeend', single);
	   console.log('end')
}
else{
    data.products.forEach(product => {

		single=`<div class="col-lg-6 col-sm-6" >
		               <a class='prodectlink' href="/singleProduct/${product._id} ">
		                  <div class="single_product_item">
								<img src="/images/products/${product.images[0]}" class="img-fluid">
								<h3> ${product.productName}</h3>
								<p>RS: ${product.price}</p>
							</div></a>
					</div>`
								 
															




		//
        //  single=`<a class='prodectlink' href="/singleProduct/${product._id} ">
        //  <div class="product">
		// 		<img src="/images/products/${product.images[0]} " alt="Product 1">
		// 		<h2>${product.category.category}</h2>
        //         <h4> ${product.productName}</h4>
		// 		<p> RS: ${product.price}</p>
		// 		<button>Add to Cart</button>
		// 	</div></a>`

			
       // document.getElementById('pages')              
        //a href       
                

                    
                
              
        
       document.getElementById('allProduct').insertAdjacentHTML('beforeend', single);
	   console.log('end')
    });
	console.log(document.getElementById('pageNumber'))
	//document.getElementById('page').insertAdjacentHTML('beforeend','<p>hi</p>')
}
if(data.products.length!=0){
let pages=parseInt(data.totelpage)
 console.log(pages)
 for(let i=1;i<=pages;i++){
	
	let divElement=	document.getElementById('pageNumber')
	let	linkElement = document.createElement("a")
	   linkElement.href=`/search?q=${query}&category=${category}&sort=${sort}&page=${i}`
	   linkElement.addEventListener('click',function(e){
		e.preventDefault();
		page=i
	let urlnew=e.target.href
        changePage(urlnew)
	   })
		linkElement.textContent = `${i}`;
		divElement.appendChild(linkElement);
	 }


}
}
document.getElementById('search-form').addEventListener('submit',function(e){
    e.preventDefault();
	
     query=this.elements.search.value
     category=this.elements.category.value
     sort=this.elements.sort.value
     findall();
})
async function changePage(newurl){
	document.getElementById('allProduct').innerHTML=""
    const res= await fetch(newurl)
const data=await res.json()
console.log(data)
let single
if(data.products.length==0){
single=`
<div class="product">
	<p>no item found</p>
                    <img src="https://ibellstore.com/images/no-item-found-here.png" alt="no order"
                        style="width: 400px; height:300px ;">
                </div>
`
document.getElementById('allprodect').insertAdjacentHTML('beforeend', single);
	   console.log('end')
}
else{
    data.products.forEach(product => {
         single=`<div class="col-lg-6 col-sm-6" >
		               <a class='prodectlink' href="/singleProduct/${product._id} ">
		                  <div class="single_product_item">
								<img src="/images/products/${product.images[0]}" class="img-fluid">
								<h3> ${product.productName}</h3>
								<p>RS: ${product.price}</p>
							</div></a>
					</div>`
       
        
       document.getElementById('allProduct').insertAdjacentHTML('beforeend', single);
	   console.log('end')
    });


}
}
</script>






